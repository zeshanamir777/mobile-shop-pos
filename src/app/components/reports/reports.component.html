<div class="space-y-6">
  <h1 class="text-3xl font-bold text-gray-900">Reports & Analytics</h1>

  <!-- Report Type Tabs -->
  <div class="flex bg-gray-100 rounded-lg p-1">
    <button
      (click)="switchReportType('daily')"
      [class]="reportType === 'daily' ? 'bg-white text-blue-600 shadow-sm' : 'text-gray-600 hover:text-gray-900'"
      class="flex-1 py-2 px-4 rounded-md font-medium transition-all"
    >
      Daily Report
    </button>
    <button
      (click)="switchReportType('monthly')"
      [class]="reportType === 'monthly' ? 'bg-white text-blue-600 shadow-sm' : 'text-gray-600 hover:text-gray-900'"
      class="flex-1 py-2 px-4 rounded-md font-medium transition-all"
    >
      Monthly Report
    </button>
    <button
      (click)="switchReportType('products')"
      [class]="reportType === 'products' ? 'bg-white text-blue-600 shadow-sm' : 'text-gray-600 hover:text-gray-900'"
      class="flex-1 py-2 px-4 rounded-md font-medium transition-all"
    >
      Product Reports
    </button>
  </div>

  <!-- Daily Report -->
  <div *ngIf="reportType === 'daily'" class="space-y-6">
    <div class="bg-white rounded-xl shadow p-4">
      <label class="block text-sm font-medium text-gray-700 mb-2">Select Date</label>
      <input
        type="date"
        [(ngModel)]="selectedDate"
        (change)="loadDailyReport()"
        class="px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none"
      />
    </div>

    <div *ngIf="loading" class="text-center py-12">
      <p class="text-gray-500">Loading report...</p>
    </div>

    <div *ngIf="!loading && dailyReport" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
      <div class="bg-white rounded-xl shadow p-6 border-l-4 border-blue-500">
        <p class="text-sm text-gray-600 mb-1">Total Sales</p>
        <p class="text-2xl font-bold text-gray-900">{{ formatCurrency(dailyReport.totalSales) }}</p>
      </div>
      <div class="bg-white rounded-xl shadow p-6 border-l-4 border-green-500">
        <p class="text-sm text-gray-600 mb-1">Total Profit</p>
        <p class="text-2xl font-bold text-gray-900">{{ formatCurrency(dailyReport.totalProfit) }}</p>
      </div>
      <div class="bg-white rounded-xl shadow p-6 border-l-4 border-red-500">
        <p class="text-sm text-gray-600 mb-1">Total Expenses</p>
        <p class="text-2xl font-bold text-gray-900">{{ formatCurrency(dailyReport.totalExpenses) }}</p>
      </div>
      <div class="bg-white rounded-xl shadow p-6 border-l-4 border-purple-500">
        <p class="text-sm text-gray-600 mb-1">Net Earnings</p>
        <p class="text-2xl font-bold" [class.text-green-600]="dailyReport.netEarnings >= 0" [class.text-red-600]="dailyReport.netEarnings < 0">
          {{ formatCurrency(dailyReport.netEarnings) }}
        </p>
      </div>
    </div>
  </div>

  <!-- Monthly Report -->
  <div *ngIf="reportType === 'monthly'" class="space-y-6">
    <div class="bg-white rounded-xl shadow p-4 flex gap-4">
      <div>
        <label class="block text-sm font-medium text-gray-700 mb-2">Year</label>
        <input
          type="number"
          [(ngModel)]="selectedYear"
          (change)="loadMonthlyReport()"
          class="px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none"
        />
      </div>
      <div class="flex-1">
        <label class="block text-sm font-medium text-gray-700 mb-2">Month</label>
        <select
          [(ngModel)]="selectedMonth"
          (change)="loadMonthlyReport()"
          class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none"
        >
          <option *ngFor="let month of months" [value]="month.value">{{ month.name }}</option>
        </select>
      </div>
    </div>

    <div *ngIf="loading" class="text-center py-12">
      <p class="text-gray-500">Loading report...</p>
    </div>

    <div *ngIf="!loading && monthlyReport" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
      <div class="bg-white rounded-xl shadow p-6 border-l-4 border-blue-500">
        <p class="text-sm text-gray-600 mb-1">Total Revenue</p>
        <p class="text-2xl font-bold text-gray-900">{{ formatCurrency(monthlyReport.totalSales) }}</p>
      </div>
      <div class="bg-white rounded-xl shadow p-6 border-l-4 border-green-500">
        <p class="text-sm text-gray-600 mb-1">Total Profit</p>
        <p class="text-2xl font-bold text-gray-900">{{ formatCurrency(monthlyReport.totalProfit) }}</p>
      </div>
      <div class="bg-white rounded-xl shadow p-6 border-l-4 border-red-500">
        <p class="text-sm text-gray-600 mb-1">Total Expenses</p>
        <p class="text-2xl font-bold text-gray-900">{{ formatCurrency(monthlyReport.totalExpenses) }}</p>
      </div>
      <div class="bg-white rounded-xl shadow p-6 border-l-4 border-purple-500">
        <p class="text-sm text-gray-600 mb-1">Net Earnings</p>
        <p class="text-2xl font-bold" [class.text-green-600]="monthlyReport.netEarnings >= 0" [class.text-red-600]="monthlyReport.netEarnings < 0">
          {{ formatCurrency(monthlyReport.netEarnings) }}
        </p>
      </div>
      <div class="bg-white rounded-xl shadow p-6 border-l-4 border-orange-500">
        <p class="text-sm text-gray-600 mb-1">Loss Days</p>
        <p class="text-2xl font-bold text-gray-900">{{ monthlyReport.lossDays }}</p>
      </div>
    </div>
  </div>

  <!-- Product Reports -->
  <div *ngIf="reportType === 'products'" class="space-y-6">
    <div *ngIf="loading" class="text-center py-12">
      <p class="text-gray-500">Loading reports...</p>
    </div>

    <div *ngIf="!loading" class="grid grid-cols-1 lg:grid-cols-3 gap-6">
      <!-- Best Selling -->
      <div class="bg-white rounded-xl shadow p-6">
        <h2 class="text-xl font-bold text-gray-900 mb-4">Best Selling Products</h2>
        <div class="space-y-3 max-h-96 overflow-y-auto">
          <div
            *ngFor="let product of bestSelling"
            class="p-3 bg-gray-50 rounded-lg border border-gray-200"
          >
            <p class="font-semibold text-gray-900">{{ product.name }}</p>
            <p class="text-sm text-gray-600">Sold: {{ product.total_sold }}</p>
            <p class="text-sm text-blue-600 font-medium">Revenue: {{ formatCurrency(product.total_revenue) }}</p>
          </div>
          <div *ngIf="bestSelling.length === 0" class="text-center py-4 text-gray-500">
            No sales data
          </div>
        </div>
      </div>

      <!-- Dead Stock -->
      <div class="bg-white rounded-xl shadow p-6">
        <h2 class="text-xl font-bold text-gray-900 mb-4">Dead Stock</h2>
        <div class="space-y-3 max-h-96 overflow-y-auto">
          <div
            *ngFor="let product of deadStock"
            class="p-3 bg-red-50 rounded-lg border border-red-200"
          >
            <p class="font-semibold text-gray-900">{{ product.name }}</p>
            <p class="text-sm text-gray-600">Stock: {{ product.stock_quantity }}</p>
            <p class="text-sm text-red-600">Never sold</p>
          </div>
          <div *ngIf="deadStock.length === 0" class="text-center py-4 text-gray-500">
            No dead stock
          </div>
        </div>
      </div>

      <!-- Low Stock -->
      <div class="bg-white rounded-xl shadow p-6">
        <h2 class="text-xl font-bold text-gray-900 mb-4">Low Stock Items</h2>
        <div class="space-y-3 max-h-96 overflow-y-auto">
          <div
            *ngFor="let product of lowStock"
            class="p-3 bg-yellow-50 rounded-lg border border-yellow-200"
          >
            <p class="font-semibold text-gray-900">{{ product.name }}</p>
            <p class="text-sm text-gray-600">Stock: {{ product.stock_quantity }}</p>
          </div>
          <div *ngIf="lowStock.length === 0" class="text-center py-4 text-gray-500">
            No low stock items
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
